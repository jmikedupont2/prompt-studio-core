import { NodeConfig } from "@pufflig/ps-types";
import { embeddingModels } from "./openai_models";

export const openaiEmbeddingNodeType = "adapter/openai_embedding" as const;

export const openaiEmbeddingConfig: NodeConfig = {
  name: "OpenAI (Embedding)",
  description: "OpenAI Embedding",
  tags: ["adapter", "embedding"],
  execution: {
    inputs: [
      {
        id: "exec:input",
      },
    ],
    outputs: [
      {
        id: "exec:output",
        name: "Completed",
      },
    ],
  },
  parameters: [
    {
      id: "api_key",
      name: "API Key",
      type: "secret",
      description: "The API key for OpenAI",
      defaultValue: "${{ps:ref:secret:openai/api_key}}",
    },
  ],
  outputs: [
    {
      id: "embedding",
      name: "Embedding",
      description: "Embedding generated by OpenAI",
      type: "vector",
      defaultValue: [],
    },
  ],
  inputs: [
    {
      id: "text",
      name: "Text",
      description: "The text to generate an embedding for",
      type: "text",
      defaultValue: "",
    },
    {
      id: "model",
      name: "Model",
      description: "The model to use",
      type: "model",
      definition: embeddingModels,
      defaultValue: {
        modelId: "text-embedding-ada-002",
        parameters: {},
      },
    },
  ],
};
